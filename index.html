<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="css/svg.css">
    <title>Hello, world!</title>
</head>

<body>
    <div style="height: 100vh; background: black;">
        <h1 class="text-center" style="font-size: 50px; font-weight: 600; color: white;">小水滴的旅程</h1>
        <h2 class="text-center" style="color: #158EBF;">水循環動態展示</h2>
    </div>
    <div class="sticky-top" style="z-index:-1">
        <svg id="svgobj" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
            viewBox="0 0 460.8 342.48">
            <defs>
                <style>
                    .cls-1 {
                        fill: none;
                        stroke: #231815;
                        stroke-miterlimit: 10;
                    }
                </style>
            </defs>
            <title>water_cycle</title>
            <g id="圖層_1" data-name="圖層 1">
                <image width="1920" height="1427" transform="scale(0.24)"
                    xlink:href="https://lh3.googleusercontent.com/vMdJbJ6aO2u8-u378pLIVwQRRd4MlYAzxJjofp3t1VpuqJwRJ0VzMn_xmHxM9pbCqsugc3ZnZQfb2BYjNcnuGTKqrp8eThZrV6qRFxQt3YoZBcjEgPR9-GK9QBrw2kPLvG5rJgsByA=w2400" />
            </g>

            <g id="圖層_2" data-name="圖層 2">

                <path id="path1" class="path" d="M345.47,211.91s1.53,13.15-17.27,14.52.76,11.32,19.41,11.78" />
                <path id="path2" class="path"
                    d="M345.47,238c0,0,59.31-4.9,60.69,14.21,0,0,1.83,14.68-47.69,14.68,0,0-44-8.87-69.1-4" />
                <path id="path3" class="path"
                    d="M290,263s-74.6-1.22-74.6-1.22-48.76-13.45-76.89-3.82S66.34,266,66.34,266s-52.13-1.84-25.68-30.88" />
                <path id="path4" class="path" d="M40.5,235L40.5,62.26" />
                <circle r="3" cy="0" cx="0" id="dot" style="fill:white" />
            </g>
        </svg>
    </div>
    <div class="row">
        <div class="col-6"></div>
        <div class="col-6">
            <div data-x="-50%" data-y="-50%" data-scale="2" data-fill="#fill1" data-path="#path1" class="maploc"
                style="height:100vh;background:rgba(0,0,0,0)">
                <h1 style="width:30vw;background:rgba(255,255,255,0.7);">
                    降雨</h1>
            </div>
            <div data-x="-50%" data-y="-70%" data-scale="2" data-fill="#fill2" data-path="#path2" class="maploc"
                style="height:100vh;background:rgba(0,0,0,0)">
                <h1 style="width:30vw;background:rgba(255,255,255,0.7);">
                    陸地逕流</h1>
            </div>
            <div data-x="25%" data-y="-60%" data-scale="1.5" data-fill="#fill3" data-path="#path3" class="maploc"
                style="height:200vh;background:rgba(0,0,0,0)">
                <h1 style="width:30vw;background:rgba(255,255,255,0.7);">
                    流入海洋</h1>
            </div>
            <div data-x="25%" data-y="10%" data-scale="1.5" data-fill="#fill3" data-path="#path4" class="maploc"
                style="height:200vh;background:rgba(0,0,0,0)">
                <h1 style="width:30vw;background:rgba(255,255,255,0.7);">
                    蒸發凝結</h1>
            </div>
        </div>
    </div>
    <div style="height:100vh;"></div>
    <div style="height:100vh;background:grey"></div>



    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
    </script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
        integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
        integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous">
    </script>



    <script>
        $(window).scroll(function () {
            var scrolled = $(document).scrollTop();
            var winh = $(window).height();

            $(".maploc").each(function () {
                var thispos = $(this).offset().top;
                var thish = $(this).height();

                // code to display polygon
                if (scrolled >= thispos && scrolled < thispos + thish) {
                    var fill_id = $(this).data("fill");
                    $(fill_id + " path").css("fill", "green");
                }

                if (scrolled >= thispos - winh / 2 && scrolled < thispos + thish - winh / 2) {

                    // code to transform position of  background svg
                    $("#svgobj").css({
                        "transform": "translate(" + $(this).data("x") + ", " + $(this).data(
                            "y") + ") scale(" + $(this).data("scale") + ")"
                    });

                    // code to change svg path percentage by scrolled percentage
                    var path = $($(this).data("path"))[0];
                    $($(this).data("path")).css("stroke-opacity", "0");
                    var length = path.getTotalLength();
                    path.style.strokeDasharray = length;
                    path.style.strokeDashoffset = length;
                    var scrollpercent = (scrolled - thispos + winh / 2) / thish;
                    var draw = length * scrollpercent;
                    path.style.strokeDashoffset = length - draw;

                    // Code to attaching dot on the path
                    var p = path.getPointAtLength(draw);
                    var dot = document.getElementById('dot');
                    dot.setAttribute("transform", `translate(${p.x}, ${p.y})`);
                }
            });
        });
    </script>
</body>

</html>